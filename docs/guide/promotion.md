# 活动类接口

## 根据活动号，批量上传兑换码接口

### 接口说明

根据请求流水号，开个店兑换码活动id，批量上传兑换码接口

### 应用场景

商户在开个店后台创建好兑换码活动后，并选中“使用自定义兑换码”选项后，可以调用该接口，上传自定义的兑换码。

用户在小程序C端兑换码页面，快捷扫描兑换码生成的二维码，或手工输入兑换码后，可以兑换相应活动的优惠券。

### 请求url

/promotion/redeemUpload

### 请求参数

#### 字段说明

| **字段**    | **类型**  | **必填**  | **举例**                 | **说明**   |
| ----------- | -------- | -------- | ------------------------ | ---------- |
| transNo     | String   | 是       | 1111                     | 商家请求流水号，请保证流水号唯一性，对于重复的流水号请求，将不会处理，请求流水号长度 <= 32 位 |
| activityId  | String   | 是       | 150929794425421824       | 开个店兑换码活动id     |
| redeemCodes | Array    | 是       | ["249916165","45782212"] | 兑换码数组，每次请求兑换码数量最多 100 个，每个兑换码的长度需 >=6 位，<=32 位，兑换码为数字字母组合。在同一个请求内的激活码，开个店在接收到请求后，会先对数组做去重，再对兑换码进行业务处理 |

#### requestBody请求示例

```json
{
    "transNo": "208888",
    "activityId": "1212311",
    "redeems": [ "12345678", "22345678", "32345678" ]
}
```

### 响应参数

#### 字段说明

| **字段**             | **类型** | **必填** | **举例**  | **说明**                                                            |
| -------------------- | -------- | -------- | --------- | ------------------------------------------------------------------- |
| successNum           | Integer  | 是       | 10        | 成功个数                                                            |
| failNum              | Integer  | 是       | 0         | 失败个数                                                            |
| errorList            | Array    | 是       |           | 失败原因集合                                                        |
| errorList\redeemCode | String   | 是       | 123456789 | 兑换码编号                                                          |
| errorList\errorCode  | String   | 是       | 001       | 错误代码 001-兑换码重复(数组重复)，002-兑换码已存在（数据库已存在） |
| errorList\errorMsg   | String   | 是       | 123456789 | 失败原因                                                            |

#### responseBody返回示例

```json
{
	"successNum": 10,
	"failNum": 1,
    "errorList": [
        {
            "redeemCode": "249916165",
			"errorCode": "001",
			"errorMsg": "兑换码重复"
        }
    ]
}
```

## 设置兑换码失效接口

### 接口说明

根据活动号、请求流水号、兑换码，作废兑换码，请求流水号和兑换码二选一。

### 应用场景

在用户退单等情况，需要将兑换码设置失效时，开发者可调用该接口，将兑换码失效。

需要注意，已经被用户兑换过的兑换码，将无法设置失效。

### 请求url

/promotion/redeemCancel

### 请求参数

#### 字段说明

| **字段**    | **类型** | **必填** | **举例**                 | **说明**                          |
| ----------- | -------- | -------- | ------------------------ | --------------------------------- |
| transNo     | String   | 否       | 1111                     | 请求流水号，请求流水号和兑换码二选一，同时存在则只处理兑换码数组。如传入transNo，将会对该请求下所有的兑换码设置失效（已经被兑换的兑换码除外）。 |
| redeemCodes | Array    | 否       | ["249916165","45782212"] | 需要设置失效的兑换码数组，请求流水号和兑换码二选一，同时存在则只处理兑换码数组。 |

#### requestBody请求示例

```json
{
    "transNo": "1212311",
    "redeems": [
        "249916165"
    ]
}
```

### 响应参数

#### 字段说明

| **字段**             | **类型** | **必填** | **举例**  | **说明**                   |
| -------------------- | -------- | -------- | --------- | ----------------------------------------- |
| successNum           | Integer  | 是       | 10        | 成功个数                   |
| failNum              | Integer  | 是       | 0         | 失败个数                   |
| errorList            | Array    | 是       |           | 失败原因集合                 |
| errorList\redeemCode | String   | 是       | 123456789 | 兑换码编号                  |
| errorList\errorCode  | String   | 是       | 123456789 | 错误代码 003-兑换码不存在，004-兑换码已使用 |
| errorList\errorMsg   | String   | 是       | 123456789 | 失败原因                   |


#### responseBody返回示例

```json
{
	"successNum": 10,
	"failNum": 1,
    "errorList": [
        {
            "redeemCode": "249916165",
			"errorCode": "003",
			"errorMsg": "兑换码不存在"
        }
    ]
}
```
